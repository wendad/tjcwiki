<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>指令详解 &mdash; 淘晶驰资料中心 1.0.0 文档</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/translations.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> 淘晶驰资料中心
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">淘晶驰教程:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="get_start.html">快速入门</a></li>
<li class="toctree-l1"><a class="reference internal" href="instruction_set.html">基本指令集</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_grammar.html">书写语法</a></li>
<li class="toctree-l1"><a class="reference internal" href="system_variables.html">系统变量</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_return.html">串口HMI设备返回数据格式</a></li>
<li class="toctree-l1"><a class="reference internal" href="name_array.html">名称组使用说明</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_applications.html">HMI高级应用与特殊指令详解</a></li>
<li class="toctree-l1"><a class="reference internal" href="usarthmi_download.html">上位机下载</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">淘晶驰资料中心</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>指令详解</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/instruction_interpretation.rst.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="toctree-wrapper compound">
</div>
<section id="id1">
<h1>指令详解<a class="headerlink" href="#id1" title="永久链接至标题"></a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="#instruction-interpretation-key"><span class="std std-ref">系统键盘使用说明</span></a></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
<li><p><span class="xref std std-ref">Instruction_interpretation_</span></p></li>
</ul>
<section id="instruction-interpretation-key">
<span id="id2"></span><h2>系统键盘使用说明<a class="headerlink" href="#instruction-interpretation-key" title="永久链接至标题"></a></h2>
<p>【目录】</p>
<section id="id3">
<h3>一、系统键盘-概述<a class="headerlink" href="#id3" title="永久链接至标题"></a></h3>
<p>1.1、系统键盘是默认存放工程内，不调用不会占用工程内存。</p>
<p>1.2、控件调用系统键盘，点击控件将会弹出系统键盘。</p>
</section>
<section id="id4">
<h3>二、系统键盘-使用说明<a class="headerlink" href="#id4" title="永久链接至标题"></a></h3>
<p>2.1、控件调用系统键盘</p>
<p>将控件vscope属性设置为全局，key属性选择相应的键盘。</p>
<img alt="_images/1_13.png" src="_images/1_13.png" />
<p>调用键盘后默认导入相关字库资源文件</p>
<img alt="_images/1_2.png" src="_images/1_2.png" />
<p>在页面窗口最下面页面生成相应键盘界面，默认键盘是上锁的，如果对键盘界面修改或者键盘里面功能进行修改，可以点击页面键盘右键解锁它并做相关的修改。如果不小心对键盘做了不必要的修改，可以右键重置键盘，键盘将会恢复默认键盘最初始的设置状态。</p>
<img alt="_images/1_3.png" src="_images/1_3.png" />
<p>2.2、支持系统键盘的控件</p>
<p>文本控件、数字控件、虚拟浮点数控件、滚动文本控件、滑动文本控件。</p>
<p>2.3、常见系统键盘修改使用</p>
<p>2.3.1、进入系统键盘将输入框清空</p>
<p>在系统键盘页面的后初始化事件配置input.txt=””</p>
<p>2.3.2、在系统键盘设置好参数通过串口发送出去</p>
<p>1.解锁键盘页面（页面默认在软件右上角）</p>
<img alt="_images/1_4.jpeg" src="_images/1_4.jpeg" />
<p>2.编辑ok按钮的弹起事件，在page指令前加上prints input.txt,0语句。</p>
<img alt="_images/1_5.png" src="_images/1_5.png" />
<div class="admonition attention">
<p class="admonition-title">注意</p>
<p>page指令之后的指令是不会被执行的，因为已经跳转到别的页面了。</p>
</div>
<p>2.3.3、不同控件在系统键盘设置好参数存储到用户存储区</p>
<p>1.设置一个全局变量，在需要系统键盘存储到用户存储区的控件按下事件对全局变量赋值（不同的控件赋值不一样）。</p>
<img alt="_images/1_6.png" src="_images/1_6.png" />
<p>2.在系统键盘页面，编辑ok按钮的弹起事件。</p>
<p>①存储变量类型为val</p>
<img alt="_images/1_7.png" src="_images/1_7.png" />
<div class="admonition attention">
<p class="admonition-title">注意</p>
<p>page指令之后的指令是不会被执行的，因为已经跳转到别的页面了。</p>
</div>
<p>②存储变量类型为txt</p>
<img alt="_images/1_8.png" src="_images/1_8.png" />
<div class="admonition attention">
<p class="admonition-title">注意</p>
<p>page指令之后的指令是不会被执行的，因为已经跳转到别的页面了。</p>
</div>
<p>默认show文本控件txt_maxl设置为32，会占比较大eeprom存储空间。</p>
<p>2.3.4、自定义键盘</p>
<p>基于官方的键盘进行更改</p>
<p>page到键盘页之前，先对键盘页的loadgageid.val和loadcmpid.vid赋值就可以了（一般是文本控件或数字控件和弹起或按下事件中进行赋值，页面名.loadpageid.val=dp，页面名.loadcmpid.val=当前控件的id），其他的逻辑会自动实现,loadpageid.val表示调用页的页面ID,loadcmpid.val表示调用页的控件ID。</p>
<div class="admonition attention">
<p class="admonition-title">注意</p>
<p>正常情况下控件设置将控件vscope属性设置为全局，key属性选择相应的键盘就好。</p>
</div>
<p>2.4、系统键盘页面常用控件和变量说明</p>
<p>①变量loadpageid.val表示调用页的页面ID。</p>
<p>②变量loadcmpid.val表示调用页的控件ID。</p>
<p>③定时器tm0是让输入框有个光标不断闪烁，如果不需要，控件属性en=0即可。</p>
<p>④变量inputlenth获取正在使用系统键盘控件字符最大长度。</p>
<p>⑤变量input表示输入的数据。</p>
<p>⑥变量show表示键盘显示的数据。</p>
<p>⑦按钮b249是让键盘输入框变成*显示。</p>
</section>
<section id="id5">
<h3>三、系统键盘使用过程中常见问题<a class="headerlink" href="#id5" title="永久链接至标题"></a></h3>
<p>1.系统键盘无法用输入法打出汉字</p>
<p>可能原因1：工程设备字符编码设置为utf-8，utf-8不支持输入法打出汉字</p>
<p>解决办法：将工程设备字符编码设置非为utf-8字符编码。</p>
<p>可能原因2：输入法键盘没有切换成输入法</p>
<p>解决办法：将系统键盘切换成中文输入法，此时下方的按钮显示为”英”。</p>
<p>可能原因3：输入的字符无法拼音构成汉字，例：”www”</p>
<p>解决办法：输入的字符为拼音可构成汉字。例：”wen”，”ni”。</p>
<p>2.系统键盘无法输入字符</p>
<p>可能原因：在调用键盘前读取了eeprom中的数据，eeprom并没有初始化，里面存储随机值中有非法字符导致输入框被填满且无法显示。</p>
<p>解决办法：第一次开机通过代码对eeprom进行一次初始化</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">for</span><span class="o">(</span><span class="nv">sys0</span><span class="o">=</span><span class="m">0</span><span class="p">;</span>sys0&lt;<span class="m">1021</span><span class="p">;</span>sys0++<span class="o">)</span>
<span class="linenos">2</span><span class="o">{</span>
<span class="linenos">3</span>   wepo <span class="m">0</span>,sys0
<span class="linenos">4</span><span class="o">}</span>
</pre></div>
</div>
<p>可能原因：修改键盘部分代码，导致键盘功能失效了。</p>
<p>解决办法：在页面窗口，右键系统键盘页面重置系统页面。</p>
<p>3.控件调用系统键盘输入值后，控件又回到默认值</p>
<p>可能原因：数据输入时是通过切换页面调用系统键盘，当输入完数据会再次回到控件的页面，此时会再次执行页面初始化事件，初始化事件的赋值会对控件重新赋值，这样就会好像控件回到默认值（复位）一样，导致调用系统键盘给控件赋值无效。</p>
<p>解决办法：</p>
<p>①不要在此控件页面初始化事件里给控件赋初始值，可以专门做一个用来上电赋初始值的页面，做为上电默认页，在此页面的初始化事件里完成所有的初始化动作之后，再切换到工程主页，这样初始化动作就只会上电执行一次，不会重复执行。</p>
<p>②在数据输入页面建一个变量（设置全局），用来表示是否已经初始化过了，赋初始值的时候判断控件是否已经被初始化过，是的话就不要再赋初值了，这样键盘调用完之后再次回来就不会重复执行了。</p>
<p>4.控件调用系统键盘输入值后，其他控件又回到默认值</p>
<p>可能原因：数据输入时是通过切换页面调用系统键盘，切换页面的时候其他控件vscope设置为私有会释放内存，恢复为默认值。若其他控件不想恢复默认值，将它的vscope属性设置为全局就好了。</p>
<span class="target" id="instruction-interpretation-ref"></span></section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2022, tjc.</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用了 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a>开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>